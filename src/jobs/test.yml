description: Run PHP unit tests

parameters:
    executor:
        type: executor
        default: default
    phpunit_path:
        type: string
        default: vendor/bin/phpunit
        description: Path to find PHP unit
    phpunit_flags:
        type: string
        description: Optional PHP unit flags

executor: << parameters.executor >>

orbs: stockfiller/composer@0.0.5

steps:
    - checkout
    - composer/install_dependencies
    - run:
          name: Run tests
          command: |
              << parameters.phpunit_path >> --log-junit /tmp/results/tests.xml << parameters.phpunit_flags >>
    - store_test_results:
      path: /tmp/results
    - store_artifacts:
      path: /tmp/results
